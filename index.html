<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>⁄òŸàÿ±ŸÜÿßŸÑ ŸÖÿπÿßŸÖŸÑÿßÿ™€å   ‚Äå </title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #f1f5f9;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: rgba(30, 41, 59, 0.95);
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            padding: 25px;
            border: 1px solid #334155;
            position: relative;
        }
        
        /* ÿ®ÿßŸÑÿßŸÜÿ≥ ÿ≠ÿ≥ÿßÿ® - ÿ®ÿ≤ÿ±⁄Øÿ™ÿ± ÿ¥ÿØŸá */
        .balance-corner {
            position: absolute;
            top: 20px;
            left: 25px;
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.9), rgba(15, 23, 42, 0.9));
            border-radius: 12px;
            padding: 15px;
            border: 1px solid #475569;
            width: 450px;
            z-index: 100;
            display: flex;
            flex-direction: column;
        }
        
        .balance-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .balance-title {
            color: #cbd5e1;
            font-size: 1rem;
            font-weight: 600;
        }
        
        .balance-buttons {
            display: flex;
            gap: 8px;
        }
        
        .balance-edit-btn, .balance-calc-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.1rem;
            padding: 6px 8px;
            border-radius: 6px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
        }
        
        .balance-edit-btn {
            color: #60a5fa;
        }
        
        .balance-calc-btn {
            color: #8b5cf6;
        }
        
        .balance-edit-btn:hover {
            background-color: rgba(96, 165, 250, 0.2);
        }
        
        .balance-calc-btn:hover {
            background-color: rgba(139, 92, 246, 0.2);
            transform: scale(1.15);
        }
        
        .balance-value {
            font-size: 1.5rem;
            font-weight: 800;
            color: #10b981;
            text-align: center;
            margin: 8px 0;
            padding: 5px;
        }
        
        .balance-details {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: #94a3b8;
            margin-top: 10px;
            padding-top: 8px;
            border-top: 1px solid rgba(148, 163, 184, 0.3);
        }
        
        /* ŸÖŸàÿØÿßŸÑ‚ÄåŸáÿß */
        .balance-modal, .details-modal, .calculator-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            display: none;
            backdrop-filter: blur(5px);
        }
        
        .balance-modal-content, .details-modal-content, .calculator-modal-content {
            background: linear-gradient(135deg, #1e293b, #0f172a);
            padding: 25px;
            border-radius: 12px;
            width: 90%;
            max-width: 400px;
            border: 1px solid #475569;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .details-modal-content {
            max-width: 500px;
        }
        
        .calculator-modal-content {
            max-width: 500px;
            padding: 0;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 20px;
            overflow: hidden;
        }
        
        /* ÿßÿ≥ÿ™ÿß€åŸÑ‚ÄåŸáÿß€å ŸÖÿßÿ¥€åŸÜ‚Äåÿ≠ÿ≥ÿßÿ® */
        .calculator-header {
            background: rgba(30, 41, 59, 0.9);
            padding: 20px;
            border-bottom: 1px solid rgba(0, 212, 255, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .calculator-header h3 {
            color: #00d4ff;
            font-size: 1.3rem;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .calculator-close-btn {
            background: rgba(255, 85, 85, 0.1);
            border: 1px solid #ff5555;
            color: #ff9999;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            border: none;
        }
        
        .calculator-close-btn:hover {
            background: rgba(255, 85, 85, 0.3);
            transform: rotate(90deg);
        }
        
        .calculator-body {
            padding: 20px;
            max-height: 60vh;
            overflow-y: auto;
        }
        
        .calculator-app-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .calculator-header-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(0, 212, 255, 0.2);
            margin-bottom: 15px;
        }
        
        .calculator-header-section h1 {
            color: #00d4ff;
            font-size: 1.5rem;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .calculator-header-section p {
            color: #a0e7ff;
            font-size: 0.85rem;
            opacity: 0.9;
        }
        
        .calculator-input-card {
            background: rgba(30, 41, 59, 0.7);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(0, 212, 255, 0.2);
            margin-bottom: 15px;
        }
        
        .calculator-input-group {
            margin-bottom: 20px;
        }
        
        .calculator-input-group:last-child {
            margin-bottom: 0;
        }
        
        .calculator-input-group label {
            display: block;
            margin-bottom: 8px;
            color: #00d4ff;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .calculator-input-with-unit {
            position: relative;
        }
        
        .calculator-input-with-unit input {
            width: 100%;
            padding: 14px;
            padding-left: 45px;
            border: 2px solid #00d4ff;
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.3);
            color: white;
            font-size: 0.95rem;
            transition: all 0.3s;
        }
        
        .calculator-unit {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #a0e7ff;
            font-size: 0.9rem;
        }
        
        .calculator-input-with-unit input:focus {
            outline: none;
            border-color: #ff00ff;
            box-shadow: 0 0 0 3px rgba(255, 0, 255, 0.2);
        }
        
        .calculator-quick-risk-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-top: 12px;
        }
        
        .calculator-risk-btn {
            padding: 14px;
            background: rgba(0, 212, 255, 0.1);
            border: 2px solid #00d4ff;
            border-radius: 10px;
            color: #a0e7ff;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            font-size: 0.95rem;
            font-weight: 600;
            min-height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .calculator-risk-btn:hover {
            background: rgba(0, 212, 255, 0.2);
            transform: translateY(-2px);
        }
        
        .calculator-risk-btn.active {
            background: #00d4ff;
            color: #1a1a2e;
            box-shadow: 0 0 15px rgba(0, 212, 255, 0.4);
        }
        
        .calculator-action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(0, 212, 255, 0.2);
        }
        
        .calculator-action-buttons button {
            flex: 1;
            padding: 18px;
            border: none;
            border-radius: 12px;
            font-size: 1.05rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            min-height: 55px;
        }
        
        #calcCalculate {
            background: linear-gradient(45deg, #00d4ff, #0099ff);
            color: white;
        }
        
        #calcReset {
            background: rgba(255, 85, 85, 0.1);
            color: #ff9999;
            border: 2px solid #ff5555;
        }
        
        #calcCalculate:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 212, 255, 0.4);
        }
        
        #calcReset:hover {
            background: rgba(255, 85, 85, 0.2);
        }
        
        .calculator-results-card {
            background: rgba(30, 41, 59, 0.7);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(0, 255, 136, 0.3);
            margin-bottom: 15px;
            display: none;
        }
        
        .calculator-results-title {
            color: #00ff88;
            font-size: 1.1rem;
            margin-bottom: 20px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .calculator-results-container {
            display: grid;
            gap: 15px;
        }
        
        .calculator-result-item {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            padding: 20px;
            border-right: 5px solid #00ff88;
            transition: transform 0.3s;
        }
        
        .calculator-result-item:nth-child(2) {
            border-right-color: #00d4ff;
        }
        
        .calculator-result-item:hover {
            transform: translateY(-5px);
        }
        
        .calculator-result-label {
            display: block;
            color: #a0e7ff;
            font-size: 0.85rem;
            margin-bottom: 8px;
            opacity: 0.9;
        }
        
        .calculator-result-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #00ff88;
            direction: ltr;
            text-align: left;
        }
        
        .calculator-result-item:nth-child(2) .calculator-result-value {
            color: #00d4ff;
        }
        
        .calculator-warning-high {
            border-right-color: #ff5555 !important;
        }
        
        .calculator-warning-high .calculator-result-value {
            color: #ff5555 !important;
        }
        
        .calculator-warning-medium {
            border-right-color: #f59e0b !important;
        }
        
        .calculator-warning-medium .calculator-result-value {
            color: #f59e0b !important;
        }
        
        .calculator-formula-box {
            background: rgba(0, 212, 255, 0.1);
            border: 1px solid #00d4ff;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }
        
        .calculator-formula-text {
            color: #a0e7ff;
            font-size: 0.85rem;
            line-height: 1.6;
        }
        
        .calculator-formula-highlight {
            color: #00ff88;
            font-weight: bold;
            font-family: monospace;
            font-size: 0.9rem;
            margin: 8px 0;
        }
        
        @keyframes calculatorFadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .calculator-results-card {
            animation: calculatorFadeInUp 0.5s ease-out;
        }
        
        .balance-modal h3 {
            color: #60a5fa;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .balance-modal-input {
            width: 100%;
            padding: 12px;
            background-color: #1e293b;
            border: 1px solid #475569;
            border-radius: 8px;
            color: #f1f5f9;
            font-size: 1.1rem;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .balance-modal-buttons {
            display: flex;
            gap: 10px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #3b82f6;
            position: relative;
            padding-top: 10px;
        }
        
        header::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 30%;
            width: 40%;
            height: 4px;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
            border-radius: 2px;
        }
        
        h1 {
            color: #60a5fa;
            font-size: 2rem;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #60a5fa, #a78bfa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .subtitle {
            color: #94a3b8;
            font-size: 1rem;
            margin-top: 5px;
        }
        
        .main-content {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }
        
        .section {
            background-color: rgba(15, 23, 42, 0.7);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #475569;
        }
        
        .section-title {
            color: #60a5fa;
            font-size: 1.3rem;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #475569;
            display: flex;
            align-items: center;
        }
        
        .section-title i {
            margin-left: 10px;
            color: #8b5cf6;
        }
        
        /* ŸÅÿ±ŸÖ ŸÖÿπÿßŸÖŸÑÿßÿ™ */
        .trade-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        label {
            margin-bottom: 6px;
            color: #cbd5e1;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        input, select {
            padding: 10px;
            background-color: #1e293b;
            border: 1px solid #475569;
            border-radius: 8px;
            font-size: 0.95rem;
            color: #f1f5f9;
            transition: all 0.3s;
            height: 44px;
        }
        
        input[type="text"] {
            font-family: 'Courier New', monospace;
            font-weight: 600;
            text-align: left;
            direction: ltr;
            font-size: 0.9rem;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
        }
        
        /* ÿ®ÿÆÿ¥ ŸÇ€åŸÖÿ™‚ÄåŸáÿß ÿØÿ± €å⁄© ÿÆÿ∑ */
        .price-row {
            grid-column: 1 / -1;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 10px;
        }
        
        @media (max-width: 768px) {
            .price-row {
                grid-template-columns: 1fr;
            }
        }
        
        .price-group {
            display: flex;
            flex-direction: column;
        }
        
        .price-label {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-bottom: 5px;
            color: #cbd5e1;
            font-weight: 600;
            font-size: 0.85rem;
        }
        
        .risk-summary {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.9), rgba(15, 23, 42, 0.9));
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #475569;
            margin-top: 10px;
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .risk-summary-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            min-width: 100px;
        }
        
        .risk-summary-value {
            font-size: 1.1rem;
            font-weight: 700;
            margin-top: 5px;
        }
        
        .form-buttons {
            grid-column: 1 / -1;
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 10px 18px;
            border: none;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            height: 44px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #6366f1);
            color: white;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #2563eb, #4f46e5);
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background-color: #475569;
            color: #e2e8f0;
        }
        
        .btn-secondary:hover {
            background-color: #64748b;
            transform: translateY(-2px);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }
        
        .btn-warning:hover {
            background: linear-gradient(135deg, #d97706, #b45309);
            transform: translateY(-2px);
        }
        
        .btn-print {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            color: white;
        }
        
        .btn-print:hover {
            background: linear-gradient(135deg, #7c3aed, #6d28d9);
            transform: translateY(-2px);
        }
        
        .btn-backup {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }
        
        .btn-backup:hover {
            background: linear-gradient(135deg, #059669, #047857);
            transform: translateY(-2px);
        }
        
        .btn-info {
            background: linear-gradient(135deg, #0ea5e9, #0284c7);
            color: white;
        }
        
        .btn-info:hover {
            background: linear-gradient(135deg, #0284c7, #0369a1);
            transform: translateY(-2px);
        }
        
        /* ÿ®ÿÆÿ¥ Ÿæÿ¥ÿ™€åÿ®ÿßŸÜ‚Äå⁄Ø€åÿ±€å */
        .backup-section {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
        }
        
        .backup-card {
            flex: 1;
            min-width: 280px;
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.9), rgba(15, 23, 42, 0.9));
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #475569;
        }
        
        .file-input {
            width: 100%;
            padding: 10px;
            background-color: #1e293b;
            border: 1px solid #475569;
            border-radius: 8px;
            color: #f1f5f9;
            margin-top: 10px;
            font-size: 0.9rem;
        }
        
        /* ÿ¨ÿØŸàŸÑ ŸÖÿπÿßŸÖŸÑÿßÿ™ */
        .trades-table-container {
            overflow-x: auto;
            border-radius: 10px;
            border: 1px solid #475569;
            margin-top: 15px;
        }
        
        .trades-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 900px;
            direction: ltr;
        }
        
        .trades-table th {
            background: linear-gradient(135deg, #1e40af, #3730a3);
            color: white;
            padding: 12px 10px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid #3b82f6;
            font-size: 0.85rem;
        }
        
        .trades-table td {
            padding: 10px;
            border-bottom: 1px solid #475569;
            font-size: 0.85rem;
            text-align: left;
        }
        
        .trades-table tr:hover {
            background-color: rgba(59, 130, 246, 0.1);
        }
        
        .profit {
            color: #10b981;
            font-weight: 700;
            background-color: rgba(16, 185, 129, 0.1);
            padding: 3px 8px;
            border-radius: 20px;
            display: inline-block;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
        }
        
        .loss {
            color: #ef4444;
            font-weight: 700;
            background-color: rgba(239, 68, 68, 0.1);
            padding: 3px 8px;
            border-radius: 20px;
            display: inline-block;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
        }
        
        .neutral {
            color: #94a3b8;
            font-weight: 700;
            background-color: rgba(148, 163, 184, 0.1);
            padding: 3px 8px;
            border-radius: 20px;
            display: inline-block;
            font-size: 0.85rem;
        }
        
        .crypto-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background-color: rgba(16, 185, 129, 0.1);
            padding: 4px 8px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85rem;
            color: #10b981;
        }
        
        .crypto-badge i {
            color: #10b981;
        }
        
        .actions {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }
        
        .btn-icon {
            padding: 5px 10px;
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 30px;
            width: 30px;
        }
        
        /* ÿ®ÿÆÿ¥ ÿ¢ŸÖÿßÿ± */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 15px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.7), rgba(15, 23, 42, 0.9));
            border-radius: 10px;
            padding: 18px;
            text-align: center;
            border: 1px solid #475569;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: 800;
            margin: 6px 0;
        }
        
        .positive {
            color: #10b981;
        }
        
        .negative {
            color: #ef4444;
        }
        
        .neutral-stat {
            color: #94a3b8;
        }
        
        /* ŸÖŸàÿØÿßŸÑ ÿ¨ÿ≤ÿ¶€åÿßÿ™ ŸÖÿπÿßŸÖŸÑŸá */
        .details-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 20px;
        }
        
        .detail-item {
            display: flex;
            flex-direction: column;
            margin-bottom: 10px;
        }
        
        .detail-label {
            color: #94a3b8;
            font-size: 0.85rem;
            margin-bottom: 3px;
        }
        
        .detail-value {
            color: #f1f5f9;
            font-weight: 600;
            font-size: 0.9rem;
            padding: 8px;
            background-color: rgba(30, 41, 59, 0.5);
            border-radius: 6px;
            border: 1px solid #475569;
        }
        
        .detail-value.price {
            font-family: 'Courier New', monospace;
            direction: ltr;
            text-align: right;
        }
        
        .detail-section {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #475569;
        }
        
        .detail-section-title {
            color: #60a5fa;
            font-size: 1rem;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .details-modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        /* ÿØ⁄©ŸÖŸá‚ÄåŸáÿß€å ÿ≥ÿ±€åÿπ ÿ±€åÿ≥⁄© - ÿ®ÿ≤ÿ±⁄Øÿ™ÿ± ÿ¥ÿØŸá */
        .quick-risk-btn {
            padding: 10px 14px;
            background-color: #475569;
            border: none;
            border-radius: 8px;
            color: #e2e8f0;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.2s;
            flex: 1;
            min-height: 40px;
        }
        
        .quick-risk-btn:hover {
            background-color: #64748b;
            transform: translateY(-2px);
        }
        
        /* ŸÜŸÖÿß€åÿ¥ ŸÇ€åŸÖÿ™‚ÄåŸáÿß€å ÿßÿπÿ¥ÿßÿ±€å */
        .price-display {
            font-family: 'Courier New', monospace;
            font-weight: 600;
            letter-spacing: 0.5px;
            direction: ltr;
            text-align: left;
            font-size: 0.9rem;
        }
        
        /* Ÿàÿß⁄©ŸÜÿ¥‚Äå⁄Øÿ±ÿß€å€å */
        @media (max-width: 1200px) {
            .balance-corner {
                position: relative;
                top: 0;
                left: 0;
                width: 100%;
                margin-bottom: 20px;
            }
        }
        
        @media (max-width: 992px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .trade-form {
                grid-template-columns: 1fr;
            }
            
            .form-buttons {
                flex-direction: column;
            }
            
            .risk-summary {
                flex-direction: column;
                gap: 10px;
            }
            
            .risk-summary-item {
                align-items: flex-start;
            }
            
            .backup-section {
                flex-direction: column;
            }
            
            .details-grid {
                grid-template-columns: 1fr;
            }
            
            .calculator-modal-content {
                width: 95%;
                max-width: 95%;
            }
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 1.6rem;
            }
            
            .balance-value {
                font-size: 1.4rem;
            }
            
            .stat-card {
                padding: 15px;
            }
            
            .stat-value {
                font-size: 1.3rem;
            }
            
            .details-modal-content {
                padding: 20px;
            }
            
            .price-row {
                grid-template-columns: 1fr;
            }
            
            .trades-table th, .trades-table td {
                padding: 8px 6px;
                font-size: 0.8rem;
            }
            
            .calculator-quick-risk-buttons {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media print {
            body {
                background: white !important;
                color: black !important;
                padding: 10px !important;
            }
            
            .container {
                box-shadow: none !important;
                border: 1px solid #ccc !important;
                background: white !important;
            }
            
            .section {
                background: white !important;
                border: 1px solid #ddd !important;
                margin-bottom: 15px !important;
                break-inside: avoid;
            }
            
            .balance-corner, button, .form-buttons, .trade-form, .actions, .backup-section {
                display: none !important;
            }
            
            .trades-table {
                min-width: 100% !important;
                font-size: 11px !important;
                direction: ltr !important;
            }
            
            .trades-table th {
                background: #f0f0f0 !important;
                color: black !important;
                border: 1px solid #ddd !important;
                text-align: left !important;
            }
            
            .trades-table td {
                border: 1px solid #ddd !important;
                text-align: left !important;
            }
            
            .profit, .loss {
                background: none !important;
                padding: 0 !important;
                font-family: inherit !important;
            }
            
            .crypto-badge {
                background: none !important;
                color: black !important;
                padding: 0 !important;
            }
            
            .stats-container {
                display: grid !important;
                grid-template-columns: repeat(4, 1fr) !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ÿ®ÿßŸÑÿßŸÜÿ≥ ÿ≠ÿ≥ÿßÿ® ÿØÿ± ⁄ØŸàÿ¥Ÿá -->
        <div class="balance-corner">
            <div class="balance-header">
                <span class="balance-title">ÿ®ÿßŸÑÿßŸÜÿ≥ ÿ≠ÿ≥ÿßÿ®</span>
                <div class="balance-buttons">
                    <button class="balance-edit-btn" onclick="openBalanceModal()" title="Ÿà€åÿ±ÿß€åÿ¥ ÿ®ÿßŸÑÿßŸÜÿ≥">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="balance-calc-btn" onclick="openCalculator()" title="ŸÖÿßÿ¥€åŸÜ‚Äåÿ≠ÿ≥ÿßÿ® ÿ±€åÿ≥⁄©">
                        <i class="fas fa-calculator"></i>
                    </button>
                </div>
            </div>
            <div class="balance-value" id="currentBalance">$1,000</div>
            <div class="balance-details">
                <span>ÿ≥ŸàÿØ/ÿ∂ÿ±ÿ±: <span id="totalPnL" style="color: #10b981;">$0</span></span>
                <span>ÿ±€åÿ≥⁄©: <span id="totalRiskPercent">0%</span></span>
            </div>
        </div>
        
        <!-- ŸÖŸàÿØÿßŸÑ Ÿà€åÿ±ÿß€åÿ¥ ÿ®ÿßŸÑÿßŸÜÿ≥ -->
        <div id="balanceModal" class="balance-modal">
            <div class="balance-modal-content">
                <h3><i class="fas fa-wallet"></i> Ÿà€åÿ±ÿß€åÿ¥ ÿ®ÿßŸÑÿßŸÜÿ≥ ÿ≠ÿ≥ÿßÿ®</h3>
                <input type="number" id="newBalanceInput" class="balance-modal-input" placeholder="ŸÖŸÇÿØÿßÿ± ÿ¨ÿØ€åÿØ ÿ®ÿßŸÑÿßŸÜÿ≥" step="0.01" value="1000">
                <div class="quick-risk-buttons" style="margin-bottom: 20px; display: flex; gap: 8px;">
                    <button type="button" class="quick-risk-btn" onclick="setBalance(2000)">$2,000</button>
                    <button type="button" class="quick-risk-btn" onclick="setBalance(5000)">$5,000</button>
                    <button type="button" class="quick-risk-btn" onclick="setBalance(10000)">$10,000</button>
                </div>
                <div class="balance-modal-buttons">
                    <button type="button" class="btn-success" onclick="updateBalance()" style="flex: 1; background: linear-gradient(135deg, #10b981, #059669); color: white;">
                        <i class="fas fa-save"></i> ÿ∞ÿÆ€åÿ±Ÿá
                    </button>
                    <button type="button" class="btn-secondary" onclick="closeBalanceModal()" style="flex: 1;">
                        <i class="fas fa-times"></i> ŸÑÿ∫Ÿà
                    </button>
                </div>
            </div>
        </div>
        
        <!-- ŸÖŸàÿØÿßŸÑ ŸÖÿßÿ¥€åŸÜ‚Äåÿ≠ÿ≥ÿßÿ® ÿ±€åÿ≥⁄© -->
        <div id="calculatorModal" class="calculator-modal">
            <div class="calculator-modal-content">
                <div class="calculator-header">
                    <h3><i class="fas fa-calculator"></i> ŸÖÿßÿ¥€åŸÜ‚Äåÿ≠ÿ≥ÿßÿ® ŸÖÿØ€åÿ±€åÿ™ ÿ±€åÿ≥⁄©</h3>
                    <button class="calculator-close-btn" onclick="closeCalculator()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="calculator-body">
                    <div class="calculator-app-container">
                        <!-- ŸáÿØÿ± ŸÖÿßÿ¥€åŸÜ‚Äåÿ≠ÿ≥ÿßÿ® -->
                        <div class="calculator-header-section">
                            <h1>üí∞ Calc Crypto</h1>
                            <p>ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ŸÖÿßÿ±ÿ¨€åŸÜ ŸÖŸàÿ±ÿØ ŸÜ€åÿßÿ≤ ÿ®ÿ± ÿßÿ≥ÿßÿ≥ ÿ±€åÿ≥⁄© Ÿà ŸÑŸàÿ±€åÿ¨</p>
                        </div>
                        
                        <!-- ⁄©ÿßÿ±ÿ™ Ÿàÿ±ŸàÿØ€å‚ÄåŸáÿß -->
                        <div class="calculator-input-card">
                            <!-- ÿ®ÿßŸÑÿßŸÜÿ≥ ÿßŸàŸÑ€åŸá -->
                            <div class="calculator-input-group">
                                <label>üí∞ Balance</label>
                                <div class="calculator-input-with-unit">
                                    <input type="number" id="calcBalance" placeholder="ŸÖÿ´ÿßŸÑ: 10000" min="1" value="10000">
                                    <span class="calculator-unit">$</span>
                                </div>
                            </div>
                            
                            <!-- ÿØÿ±ÿµÿØ ÿ±€åÿ≥⁄© ⁄©ŸÑ -->
                            <div class="calculator-input-group">
                                <label>‚ö†Ô∏è Risk</label>
                                <div class="calculator-input-with-unit">
                                    <input type="number" id="calcRiskPercent" placeholder="ŸÖÿ´ÿßŸÑ: 1" step="0.01" min="0.01" max="100" value="1">
                                    <span class="calculator-unit">%</span>
                                </div>
                                
                                <div class="calculator-quick-risk-buttons">
                                    <div class="calculator-risk-btn" data-risk="0.25">0.25%</div>
                                    <div class="calculator-risk-btn active" data-risk="0.5">0.5%</div>
                                    <div class="calculator-risk-btn" data-risk="1">1%</div>
                                </div>
                            </div>
                            
                            <!-- ÿØÿ±ÿµÿØ ÿ≠ÿØ ÿ∂ÿ±ÿ± ŸæŸàÿ≤€åÿ¥ŸÜ -->
                            <div class="calculator-input-group">
                                <label>üìâ Stop Loss</label>
                                <div class="calculator-input-with-unit">
                                    <input type="number" id="calcStopLossPercent" placeholder="ŸÖÿ´ÿßŸÑ: 5" step="0.1" min="0.1" max="100" value="5">
                                    <span class="calculator-unit">%</span>
                                </div>
                            </div>
                            
                            <!-- ŸÑŸàÿ±€åÿ¨ -->
                            <div class="calculator-input-group">
                                <label>‚ö° Leverage</label>
                                <div class="calculator-input-with-unit">
                                    <input type="number" id="calcLeverage" placeholder="ŸÖÿ´ÿßŸÑ: 10" step="1" min="1" max="1000" value="10">
                                    <span class="calculator-unit">x</span>
                                </div>
                            </div>
                            
                            <!-- ÿØ⁄©ŸÖŸá‚ÄåŸáÿß€å ÿπŸÖŸÑ€åÿßÿ™€å -->
                            <div class="calculator-action-buttons">
                                <button id="calcCalculate">ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ŸÖÿßÿ±ÿ¨€åŸÜ</button>
                                <button id="calcReset">Ÿæÿß⁄© ⁄©ÿ±ÿØŸÜ</button>
                            </div>
                        </div>
                        
                        <!-- ⁄©ÿßÿ±ÿ™ ŸÜÿ™ÿß€åÿ¨ -->
                        <div class="calculator-results-card" id="calcResult">
                            <div class="calculator-results-title">
                                üìä ŸÜÿ™ÿß€åÿ¨ ŸÖÿ≠ÿßÿ≥ÿ®Ÿá
                            </div>
                            
                            <div class="calculator-results-container">
                                <!-- ŸÖÿ®ŸÑÿ∫ ÿ±€åÿ≥⁄© -->
                                <div class="calculator-result-item" id="calcRiskResultItem">
                                    <span class="calculator-result-label">Loss</span>
                                    <span class="calculator-result-value" id="calcRiskAmount">0$</span>
                                </div>
                                
                                <!-- ŸÖÿßÿ±ÿ¨€åŸÜ ŸÖŸàÿ±ÿØ ŸÜ€åÿßÿ≤ -->
                                <div class="calculator-result-item" id="calcMarginResultItem">
                                    <span class="calculator-result-label">Marjin</span>
                                    <span class="calculator-result-value" id="calcMarginRequired">0$</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ŸÅÿ±ŸÖŸàŸÑ -->
                        <div class="calculator-formula-box">
                            <div class="calculator-formula-text">
                                <strong>üßÆ ŸÅÿ±ŸÖŸàŸÑ ŸÖÿ≠ÿßÿ≥ÿ®Ÿá:</strong><br>
                                <span class="calculator-formula-highlight">
                                    ŸÖÿßÿ±ÿ¨€åŸÜ = (ÿ®ÿßŸÑÿßŸÜÿ≥ √ó ÿ±€åÿ≥⁄©%) √∑ (ÿ≠ÿØ ÿ∂ÿ±ÿ±% √ó ŸÑŸàÿ±€åÿ¨)
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ŸÖŸàÿØÿßŸÑ ÿ¨ÿ≤ÿ¶€åÿßÿ™ ŸÖÿπÿßŸÖŸÑŸá -->
        <div id="detailsModal" class="details-modal">
            <div class="details-modal-content">
                <h3 style="color: #60a5fa; margin-bottom: 20px; text-align: center; display: flex; align-items: center; justify-content: center; gap: 10px;">
                    <i class="fas fa-chart-line"></i>
                    ÿ¨ÿ≤ÿ¶€åÿßÿ™ ŸÖÿπÿßŸÖŸÑŸá
                </h3>
                
                <div class="details-grid">
                    <div class="detail-item">
                        <span class="detail-label">ÿßÿ±ÿ≤ ÿØ€åÿ¨€åÿ™ÿßŸÑ</span>
                        <div class="detail-value" id="detail-symbol">BTC</div>
                    </div>
                    
                    <div class="detail-item">
                        <span class="detail-label">ŸÜŸàÿπ ŸÖÿπÿßŸÖŸÑŸá</span>
                        <div class="detail-value" id="detail-type">ŸÑÿßŸÜ⁄Ø</div>
                    </div>
                    
                    <div class="detail-item">
                        <span class="detail-label">ÿ™ÿßÿ±€åÿÆ ŸÖÿπÿßŸÖŸÑŸá</span>
                        <div class="detail-value" id="detail-date">1402/10/15 - 14:30</div>
                    </div>
                    
                    <div class="detail-item">
                        <span class="detail-label">Ÿàÿ∂ÿπ€åÿ™</span>
                        <div class="detail-value" id="detail-status">ÿ®ÿßÿ≤</div>
                    </div>
                </div>
                
                <div class="detail-section">
                    <div class="detail-section-title">
                        <i class="fas fa-chart-area"></i>
                        ŸÇ€åŸÖÿ™‚ÄåŸáÿß
                    </div>
                    
                    <div class="details-grid">
                        <div class="detail-item">
                            <span class="detail-label">ŸÇ€åŸÖÿ™ Ÿàÿ±ŸàÿØ</span>
                            <div class="detail-value price" id="detail-entry">90075</div>
                        </div>
                        
                        <div class="detail-item">
                            <span class="detail-label">ÿ≠ÿØ ÿ∂ÿ±ÿ±</span>
                            <div class="detail-value price" id="detail-sl">89861</div>
                        </div>
                        
                        <div class="detail-item">
                            <span class="detail-label">ÿ≠ÿØ ÿ≥ŸàÿØ</span>
                            <div class="detail-value price" id="detail-tp">90715</div>
                        </div>
                        
                        <div class="detail-item" id="detail-closed-price-container" style="display: none;">
                            <span class="detail-label">ŸÇ€åŸÖÿ™ ÿ®ÿ≥ÿ™Ÿá ÿ¥ÿØŸÜ</span>
                            <div class="detail-value price" id="detail-closed-price">-</div>
                        </div>
                    </div>
                </div>
                
                <div class="detail-section">
                    <div class="detail-section-title">
                        <i class="fas fa-calculator"></i>
                        ŸÖÿ≠ÿßÿ≥ÿ®ÿßÿ™ ÿ±€åÿ≥⁄©
                    </div>
                    
                    <div class="details-grid">
                        <div class="detail-item">
                            <span class="detail-label">ÿ±€åÿ≥⁄© (% ÿßÿ≤ ÿ®ÿßŸÑÿßŸÜÿ≥)</span>
                            <div class="detail-value" id="detail-risk-percent">0.5%</div>
                        </div>
                        
                        <div class="detail-item">
                            <span class="detail-label">ŸÖŸÇÿØÿßÿ± ÿ±€åÿ≥⁄© ($)</span>
                            <div class="detail-value" id="detail-risk-amount">$5.00</div>
                        </div>
                        
                        <div class="detail-item">
                            <span class="detail-label">ÿßŸÜÿØÿßÿ≤Ÿá ŸæŸàÿ≤€åÿ¥ŸÜ</span>
                            <div class="detail-value" id="detail-position-size">0.0234</div>
                        </div>
                        
                        <div class="detail-item">
                            <span class="detail-label">ÿ±€åÿ≥⁄© ÿ®Ÿá ÿ±€åŸàÿßÿ±ÿØ</span>
                            <div class="detail-value" id="detail-rr">1:1.5</div>
                        </div>
                    </div>
                </div>
                
                <div class="detail-section" id="detail-result-section" style="display: none;">
                    <div class="detail-section-title">
                        <i class="fas fa-coins"></i>
                        ŸÜÿ™€åÿ¨Ÿá ŸÖÿπÿßŸÖŸÑŸá
                    </div>
                    
                    <div class="details-grid">
                        <div class="detail-item">
                            <span class="detail-label">ÿ≥ŸàÿØ/ÿ∂ÿ±ÿ±</span>
                            <div class="detail-value" id="detail-pnl">+$12.50</div>
                        </div>
                        
                        <div class="detail-item">
                            <span class="detail-label">ÿ™ÿßÿ±€åÿÆ ÿ®ÿ≥ÿ™Ÿá ÿ¥ÿØŸÜ</span>
                            <div class="detail-value" id="detail-closed-date">1402/10/16 - 09:45</div>
                        </div>
                    </div>
                </div>
                
                <div class="details-modal-buttons">
                    <button type="button" class="btn-secondary" onclick="closeDetailsModal()" style="flex: 1;">
                        <i class="fas fa-times"></i> ÿ®ÿ≥ÿ™ŸÜ
                    </button>
                </div>
            </div>
        </div>
        
        <header>
            <h1>
                <i class="fas fa-coins"></i>
                ⁄òŸàÿ±ŸÜÿßŸÑ ŸÖÿπÿßŸÖŸÑÿßÿ™€å ⁄©ÿ±€åŸæÿ™Ÿà
            </h1>
            <p class="subtitle">  R-NIKER  </p>
        </header>
        
        <main class="main-content">
            <!-- ÿ®ÿÆÿ¥ ÿ´ÿ®ÿ™ ŸÖÿπÿßŸÖŸÑŸá -->
            <section class="section">
                <h2 class="section-title"><i class="fas fa-plus-circle"></i> ÿ´ÿ®ÿ™ ŸÖÿπÿßŸÖŸÑŸá ÿ¨ÿØ€åÿØ</h2>
                <form id="tradeForm" class="trade-form">
                    <div class="form-group">
                        <label for="symbol"><i class="fas fa-coins"></i> ÿßÿ±ÿ≤ ÿØ€åÿ¨€åÿ™ÿßŸÑ</label>
                        <input type="text" id="symbol" list="crypto-list" placeholder="ŸÖÿ´ÿßŸÑ: BTC, ETH, ..." required>
                        <datalist id="crypto-list">
                            <option value="BTC">ÿ®€åÿ™‚Äå⁄©Ÿà€åŸÜ</option>
                            <option value="ETH">ÿßÿ™ÿ±€åŸàŸÖ</option>
                            <option value="BNB">ÿ®ÿß€åŸÜŸÜÿ≥ ⁄©Ÿà€åŸÜ</option>
                            <option value="SOL">ÿ≥ŸàŸÑÿßŸÜÿß</option>
                            <option value="XRP">ÿ±€åŸæŸÑ</option>
                            <option value="DOGE">ÿØŸàÿ¨ ⁄©Ÿà€åŸÜ</option>
                            <option value="ADA">⁄©ÿßÿ±ÿØÿßŸÜŸà</option>
                            <option value="DOT">ŸæŸàŸÑ⁄©ÿßÿØÿßÿ™</option>
                        </datalist>
                    </div>
                    
                    <div class="form-group">
                        <label for="date"><i class="fas fa-calendar"></i> ÿ™ÿßÿ±€åÿÆ ŸÖÿπÿßŸÖŸÑŸá</label>
                        <input type="datetime-local" id="date" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="type"><i class="fas fa-exchange-alt"></i> ŸÜŸàÿπ ŸÖÿπÿßŸÖŸÑŸá</label>
                        <select id="type" required>
                            <option value="buy">ŸÑÿßŸÜ⁄Ø (ÿÆÿ±€åÿØ)</option>
                            <option value="sell">ÿ¥Ÿàÿ±ÿ™ (ŸÅÿ±Ÿàÿ¥)</option>
                        </select>
                    </div>
                    
                    <!-- ŸÇ€åŸÖÿ™‚ÄåŸáÿß ÿØÿ± €å⁄© ÿÆÿ∑ -->
                    <div class="price-row">
                        <div class="price-group">
                            <div class="price-label">
                                <i class="fas fa-arrow-down"></i>
                                <span>ŸÇ€åŸÖÿ™ Ÿàÿ±ŸàÿØ</span>
                            </div>
                            <input type="text" id="entryPrice" placeholder="ŸÖÿ´ÿßŸÑ: 90075 €åÿß 0.610" required class="price-display">
                        </div>
                        
                        <div class="price-group">
                            <div class="price-label">
                                <i class="fas fa-shield-alt"></i>
                                <span>ÿ≠ÿØ ÿ∂ÿ±ÿ±</span>
                            </div>
                            <input type="text" id="stopLoss" placeholder="ŸÖÿ´ÿßŸÑ: 89861 €åÿß 0.590" required class="price-display">
                        </div>
                        
                        <div class="price-group">
                            <div class="price-label">
                                <i class="fas fa-bullseye"></i>
                                <span>ÿ≠ÿØ ÿ≥ŸàÿØ</span>
                            </div>
                            <input type="text" id="takeProfit" placeholder="ŸÖÿ´ÿßŸÑ: 90715 €åÿß 0.630" required class="price-display">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="riskPercent"><i class="fas fa-percentage"></i> ÿ±€åÿ≥⁄© (% ÿßÿ≤ ÿ®ÿßŸÑÿßŸÜÿ≥)</label>
                        <div style="display: flex; gap: 6px; margin-top: 5px;">
                            <button type="button" class="quick-risk-btn" onclick="setRiskPercent(0.25)">0.25%</button>
                            <button type="button" class="quick-risk-btn" onclick="setRiskPercent(0.5)">0.5%</button>
                            <button type="button" class="quick-risk-btn" onclick="setRiskPercent(1)">1%</button>
                        </div>
                        <input type="text" id="riskPercent" placeholder="ŸÖÿ´ÿßŸÑ: 0.5" value="0.5" required style="margin-top: 8px;">
                    </div>
                    
                    <!-- ÿÆŸÑÿßÿµŸá ÿ±€åÿ≥⁄© -->
                    <div class="risk-summary">
                        <div class="risk-summary-item">
                            <span style="color: #cbd5e1; font-size: 0.85rem;">ŸÖŸÇÿØÿßÿ± ÿ±€åÿ≥⁄©</span>
                            <span class="risk-summary-value" id="riskAmount" style="color: #ef4444;">$0</span>
                        </div>
                        <div class="risk-summary-item">
                            <span style="color: #cbd5e1; font-size: 0.85rem;">ÿ≥ŸàÿØ ÿ®ÿßŸÑŸÇŸàŸá</span>
                            <span class="risk-summary-value" id="potentialProfit" style="color: #10b981;">$0</span>
                        </div>
                        <div class="risk-summary-item">
                            <span style="color: #cbd5e1; font-size: 0.85rem;">ÿ±€åÿ≥⁄© ÿ®Ÿá ÿ±€åŸàÿßÿ±ÿØ</span>
                            <span class="risk-summary-value" id="riskRewardRatio">1:0</span>
                        </div>
                    </div>
                    
                    <div class="form-buttons">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i> ÿ´ÿ®ÿ™ ŸÖÿπÿßŸÖŸÑŸá
                        </button>
                        <button type="reset" class="btn-secondary">
                            <i class="fas fa-eraser"></i> Ÿæÿß⁄© ⁄©ÿ±ÿØŸÜ
                        </button>
                        <button type="button" class="btn-warning" onclick="calculateRisk()">
                            <i class="fas fa-calculator"></i> ŸÖÿ≠ÿßÿ≥ÿ®Ÿá
                        </button>
                    </div>
                </form>
            </section>
            
            <!-- ÿ®ÿÆÿ¥ ÿ™ÿßÿ±€åÿÆ⁄ÜŸá ŸÖÿπÿßŸÖŸÑÿßÿ™ -->
            <section class="section">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h2 class="section-title" style="margin-bottom: 0;"><i class="fas fa-history"></i> ÿ™ÿßÿ±€åÿÆ⁄ÜŸá ŸÖÿπÿßŸÖŸÑÿßÿ™</h2>
                    <button class="btn-print" onclick="window.print()">
                        <i class="fas fa-print"></i> Ÿæÿ±€åŸÜÿ™ ⁄Øÿ≤ÿßÿ±ÿ¥
                    </button>
                </div>
                <div class="trades-table-container">
                    <table class="trades-table">
                        <thead>
                            <tr>
                                <th>ÿßÿ±ÿ≤</th>
                                <th>ÿ™ÿßÿ±€åÿÆ</th>
                                <th>ŸÜŸàÿπ</th>
                                <th>Ÿàÿ±ŸàÿØ</th>
                                <th>ÿ≠ÿØ ÿ∂ÿ±ÿ±</th>
                                <th>ÿ≠ÿØ ÿ≥ŸàÿØ</th>
                                <th>ÿ±€åÿ≥⁄© %</th>
                                <th>Ÿàÿ∂ÿπ€åÿ™</th>
                                <th>ÿ≥ŸàÿØ/ÿ∂ÿ±ÿ±</th>
                                <th>ÿπŸÖŸÑ€åÿßÿ™</th>
                            </tr>
                        </thead>
                        <tbody id="tradesTableBody">
                            <!-- ŸÖÿπÿßŸÖŸÑÿßÿ™ ÿß€åŸÜÿ¨ÿß ŸÜŸÖÿß€åÿ¥ ÿØÿßÿØŸá ŸÖ€å‚Äåÿ¥ŸàŸÜÿØ -->
                        </tbody>
                    </table>
                </div>
                <p id="noTradesMessage" style="text-align: center; padding: 30px; color: #94a3b8; display: none;">
                    <i class="fas fa-exchange-alt" style="font-size: 2rem; margin-bottom: 15px; display: block;"></i>
                    ŸáŸÜŸàÿ≤ Ÿá€å⁄Ü ŸÖÿπÿßŸÖŸÑŸá‚Äåÿß€å ÿ´ÿ®ÿ™ ŸÜÿ¥ÿØŸá ÿßÿ≥ÿ™!
                </p>
            </section>
            
            <!-- ÿ®ÿÆÿ¥ ÿ¢ŸÖÿßÿ± Ÿà ÿ™ÿ≠ŸÑ€åŸÑ -->
            <section class="section">
                <h2 class="section-title"><i class="fas fa-chart-bar"></i> ÿ¢ŸÖÿßÿ± ÿπŸÖŸÑ⁄©ÿ±ÿØ</h2>
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-label">ÿ™ÿπÿØÿßÿØ ŸÖÿπÿßŸÖŸÑÿßÿ™</div>
                        <div class="stat-value neutral-stat" id="totalTrades">0</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">ÿ≥ŸàÿØ ⁄©ŸÑ</div>
                        <div class="stat-value" id="totalProfit">$0</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">ÿ∂ÿ±ÿ± ⁄©ŸÑ</div>
                        <div class="stat-value" id="totalLoss">$0</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">ŸÜÿ±ÿÆ ŸÖŸàŸÅŸÇ€åÿ™</div>
                        <div class="stat-value" id="winRate">0%</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">ÿ®€åÿ¥ÿ™ÿ±€åŸÜ ÿ≥ŸàÿØ</div>
                        <div class="stat-value positive" id="maxProfit">$0</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">ÿ®€åÿ¥ÿ™ÿ±€åŸÜ ÿ∂ÿ±ÿ±</div>
                        <div class="stat-value negative" id="maxLoss">$0</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">ŸÖÿπÿßŸÖŸÑÿßÿ™ ÿ®ÿßÿ≤</div>
                        <div class="stat-value neutral-stat" id="openTrades">0</div>
                    </div>
                </div>
            </section>
            
            <!-- ÿ®ÿÆÿ¥ Ÿæÿ¥ÿ™€åÿ®ÿßŸÜ‚Äå⁄Ø€åÿ±€å -->
            <section class="section">
                <h2 class="section-title"><i class="fas fa-database"></i> Ÿæÿ¥ÿ™€åÿ®ÿßŸÜ‚Äå⁄Ø€åÿ±€å Ÿà ÿ®ÿßÿ≤€åÿßÿ®€å</h2>
                <div class="backup-section">
                    <div class="backup-card">
                        <h3 style="color: #60a5fa; margin-bottom: 15px; font-size: 1.1rem;">
                            <i class="fas fa-download"></i> ÿØÿ±€åÿßŸÅÿ™ Ÿæÿ¥ÿ™€åÿ®ÿßŸÜ
                        </h3>
                        <p style="color: #cbd5e1; margin-bottom: 15px; font-size: 0.85rem;">
                            ÿ™ŸÖÿßŸÖ ŸÖÿπÿßŸÖŸÑÿßÿ™ Ÿà ÿßÿ∑ŸÑÿßÿπÿßÿ™ ÿ≠ÿ≥ÿßÿ® ÿÆŸàÿØ ÿ±ÿß ÿØÿ± €å⁄© ŸÅÿß€åŸÑ ÿ∞ÿÆ€åÿ±Ÿá ⁄©ŸÜ€åÿØ.
                        </p>
                        <button class="btn-backup" onclick="exportData()">
                            <i class="fas fa-file-export"></i> ÿØÿßŸÜŸÑŸàÿØ Ÿæÿ¥ÿ™€åÿ®ÿßŸÜ
                        </button>
                    </div>
                    
                    <div class="backup-card">
                        <h3 style="color: #60a5fa; margin-bottom: 15px; font-size: 1.1rem;">
                            <i class="fas fa-upload"></i> ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å Ÿæÿ¥ÿ™€åÿ®ÿßŸÜ
                        </h3>
                        <p style="color: #cbd5e1; margin-bottom: 15px; font-size: 0.85rem;">
                            ÿßÿ∑ŸÑÿßÿπÿßÿ™ ŸÇÿ®ŸÑ€å ÿÆŸàÿØ ÿ±ÿß ÿßÿ≤ ŸÅÿß€åŸÑ ÿ®ÿßÿ≤€åÿßÿ®€å ⁄©ŸÜ€åÿØ.
                        </p>
                        <input type="file" id="backupFile" class="file-input" accept=".json">
                        <button class="btn-backup" onclick="importData()" style="margin-top: 10px;">
                            <i class="fas fa-file-import"></i> ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å Ÿæÿ¥ÿ™€åÿ®ÿßŸÜ
                        </button>
                    </div>
                </div>
                <div style="color: #94a3b8; margin-top: 15px; font-size: 0.8rem; padding: 10px; background: rgba(59, 130, 246, 0.1); border-radius: 8px;">
                    <i class="fas fa-info-circle"></i> ÿ™Ÿàÿ¨Ÿá: ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å ŸÅÿß€åŸÑ ÿ¨ÿØ€åÿØÿå ÿßÿ∑ŸÑÿßÿπÿßÿ™ ŸÅÿπŸÑ€å ÿ±ÿß ÿ¨ÿß€å⁄Øÿ≤€åŸÜ ŸÖ€å‚Äå⁄©ŸÜÿØ.
                </div>
            </section>
        </main>
        
        <footer style="text-align: center; margin-top: 40px; padding-top: 20px; border-top: 1px solid #475569; color: #94a3b8; font-size: 0.85rem;">
            <p>Supoprt : ID Telegram : @RNA7600</p>
        </footer>
    </div>

    <script>
        // ============================
        // ÿ®ÿÆÿ¥ ŸÖÿØ€åÿ±€åÿ™ ⁄òŸàÿ±ŸÜÿßŸÑ ÿ™ÿ±€åÿØ€åŸÜ⁄Ø
        // ============================
        
        // ŸÖÿØ€åÿ±€åÿ™ ÿØÿßÿØŸá‚ÄåŸáÿß
        let accountBalance = parseFloat(localStorage.getItem('crypto_account_balance')) || 1000;
        let trades = JSON.parse(localStorage.getItem('crypto_trades')) || [];
        
        // ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å ÿßŸàŸÑ€åŸá
        document.addEventListener('DOMContentLoaded', function() {
            // ÿ™ŸÜÿ∏€åŸÖ ÿ™ÿßÿ±€åÿÆ Ÿà ÿ≤ŸÖÿßŸÜ ŸÅÿπŸÑ€å
            const now = new Date();
            const timezoneOffset = now.getTimezoneOffset() * 60000;
            const localISOTime = new Date(now - timezoneOffset).toISOString().slice(0, 16);
            document.getElementById('date').value = localISOTime;
            
            // ŸÜŸÖÿß€åÿ¥ ÿ®ÿßŸÑÿßŸÜÿ≥ Ÿà ÿ±€åÿ≥⁄©
            updateBalanceDisplay();
            updateTotalRisk();
            
            // ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å ŸÖÿπÿßŸÖŸÑÿßÿ™
            loadTrades();
            updateStats();
            
            // ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ÿ±€åÿ≥⁄© ŸáŸÜ⁄ØÿßŸÖ ÿ™ÿ∫€å€åÿ± Ÿàÿ±ŸàÿØ€å‚ÄåŸáÿß
            document.getElementById('entryPrice').addEventListener('input', calculateRisk);
            document.getElementById('stopLoss').addEventListener('input', calculateRisk);
            document.getElementById('takeProfit').addEventListener('input', calculateRisk);
            document.getElementById('riskPercent').addEventListener('input', calculateRisk);
            
            // ŸÖŸÇÿØÿßÿ±ÿØŸá€å ÿßŸàŸÑ€åŸá ŸÖÿßÿ¥€åŸÜ‚Äåÿ≠ÿ≥ÿßÿ®
            initCalculator();
        });
        
        // ŸÜŸÖÿß€åÿ¥ ÿ®ÿßŸÑÿßŸÜÿ≥ ÿØÿ± ⁄ØŸàÿ¥Ÿá
        function updateBalanceDisplay() {
            document.getElementById('currentBalance').textContent = '$' + formatNumber(accountBalance);
            
            // ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ÿ≥ŸàÿØ/ÿ∂ÿ±ÿ± ⁄©ŸÑ
            const totalPnL = calculateTotalPnL();
            const totalPnLElement = document.getElementById('totalPnL');
            totalPnLElement.textContent = (totalPnL >= 0 ? '+' : '') + formatCurrency(Math.abs(totalPnL));
            totalPnLElement.style.color = totalPnL >= 0 ? '#10b981' : '#ef4444';
        }
        
        // ŸÅÿ±ŸÖÿ™ ÿßÿ±ÿ≤ ÿ®ÿ±ÿß€å ÿ≥ŸàÿØ/ÿ∂ÿ±ÿ± (ŸáŸÖ€åÿ¥Ÿá €≤ ÿ±ŸÇŸÖ ÿßÿπÿ¥ÿßÿ±)
        function formatCurrency(num) {
            return '$' + parseFloat(num).toLocaleString('en-US', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });
        }
        
        // ŸÅÿ±ŸÖÿ™ ÿßÿπÿØÿßÿØ ÿ®ÿ±ÿß€å ŸÜŸÖÿß€åÿ¥ ÿπŸÖŸàŸÖ€å
        function formatNumber(num) {
            const numValue = parseFloat(num);
            // ÿß⁄Øÿ± ÿπÿØÿØ ÿßÿπÿ¥ÿßÿ±€å ÿßÿ≥ÿ™ÿå ÿ≠ÿØÿß⁄©ÿ´ÿ± €∏ ÿ±ŸÇŸÖ ÿßÿπÿ¥ÿßÿ± ŸÜÿ¥ÿßŸÜ ÿ®ÿØŸá
            if (numValue % 1 !== 0) {
                return numValue.toLocaleString('en-US', {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 8
                });
            }
            // ÿß⁄Øÿ± ÿπÿØÿØ ÿµÿ≠€åÿ≠ ÿßÿ≥ÿ™ÿå ÿ®ÿØŸàŸÜ ÿßÿπÿ¥ÿßÿ± ŸÜÿ¥ÿßŸÜ ÿ®ÿØŸá
            return numValue.toLocaleString('en-US');
        }
        
        // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å ÿ±€åÿ≥⁄© ⁄©ŸÑ
        function updateTotalRisk() {
            const openTrades = trades.filter(t => t.status === 'open');
            let totalRiskAmount = 0;
            
            openTrades.forEach(trade => {
                const riskData = calculateTradeRisk(trade);
                if (riskData.riskAmount) {
                    totalRiskAmount += riskData.riskAmount;
                }
            });
            
            const totalRiskPercent = accountBalance > 0 ? (totalRiskAmount / accountBalance) * 100 : 0;
            
            document.getElementById('totalRiskPercent').textContent = totalRiskPercent.toFixed(2) + '%';
        }
        
        // ÿ™ŸÜÿ∏€åŸÖ ÿØÿ±ÿµÿØ ÿ±€åÿ≥⁄©
        function setRiskPercent(percent) {
            document.getElementById('riskPercent').value = percent;
            calculateRisk();
        }
        
        // ÿ™ŸÜÿ∏€åŸÖ ÿ®ÿßŸÑÿßŸÜÿ≥ ÿ≥ÿ±€åÿπ
        function setBalance(amount) {
            document.getElementById('newBalanceInput').value = amount;
        }
        
        // ÿ®ÿßÿ≤ ⁄©ÿ±ÿØŸÜ ŸÖŸàÿØÿßŸÑ ÿ®ÿßŸÑÿßŸÜÿ≥
        function openBalanceModal() {
            document.getElementById('newBalanceInput').value = accountBalance;
            document.getElementById('balanceModal').style.display = 'flex';
        }
        
        // ÿ®ÿ≥ÿ™ŸÜ ŸÖŸàÿØÿßŸÑ ÿ®ÿßŸÑÿßŸÜÿ≥
        function closeBalanceModal() {
            document.getElementById('balanceModal').style.display = 'none';
        }
        
        // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å ÿ®ÿßŸÑÿßŸÜÿ≥ ÿ≠ÿ≥ÿßÿ®
        function updateBalance() {
            const newBalanceInput = document.getElementById('newBalanceInput');
            let newBalance = parseFloat(newBalanceInput.value);
            
            // ŸÖÿØ€åÿ±€åÿ™ ÿßÿπÿØÿßÿØ ÿßÿπÿ¥ÿßÿ±€å
            newBalance = Math.round(newBalance * 100) / 100;
            
            if (!isNaN(newBalance) && newBalance > 0) {
                accountBalance = newBalance;
                localStorage.setItem('crypto_account_balance', accountBalance);
                updateBalanceDisplay();
                updateTotalRisk();
                updateStats();
                calculateRisk();
                closeBalanceModal();
                showNotification('ÿ®ÿßŸÑÿßŸÜÿ≥ ÿ≠ÿ≥ÿßÿ® ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å ÿ¥ÿØ.', 'success');
            } else {
                showNotification('ŸÑÿ∑ŸÅÿßŸã €å⁄© ÿπÿØÿØ ŸÖÿπÿ™ÿ®ÿ± Ÿàÿßÿ±ÿØ ⁄©ŸÜ€åÿØ.', 'error');
            }
        }
        
        // ÿ≠ÿ∞ŸÅ ÿµŸÅÿ±Ÿáÿß€å ÿßÿ∂ÿßŸÅ€å ÿßÿ≤ ÿßŸÜÿ™Ÿáÿß€å ÿπÿØÿØ
        function trimTrailingZeros(numStr) {
            if (!numStr.includes('.')) return numStr;
            
            // ÿ≠ÿ∞ŸÅ ÿµŸÅÿ±Ÿáÿß€å ÿßŸÜÿ™Ÿáÿß€å€å
            let trimmed = numStr.replace(/\.?0+$/, '');
            
            // ÿß⁄Øÿ± ŸÜŸÇÿ∑Ÿá ÿ™ŸÜŸáÿß ŸÖÿßŸÜÿØŸáÿå ÿ¢ŸÜ ÿ±ÿß ŸáŸÖ ÿ≠ÿ∞ŸÅ ⁄©ŸÜ
            if (trimmed.endsWith('.')) {
                trimmed = trimmed.slice(0, -1);
            }
            
            return trimmed;
        }
        
        // ÿ≠ŸÅÿ∏ ÿØŸÇ€åŸÇ ÿ±ÿ¥ÿ™Ÿá ÿπÿØÿØ€å Ÿàÿ±ŸàÿØ€å ⁄©ÿßÿ±ÿ®ÿ±
        function preserveOriginalNumber(numStr) {
            // ÿßÿ®ÿ™ÿØÿß ÿ™ÿ®ÿØ€åŸÑ ÿ®Ÿá ÿπÿØÿØ Ÿà ÿ≥Ÿæÿ≥ ÿ®Ÿá ÿ±ÿ¥ÿ™Ÿá ÿ®ÿ±ÿß€å ÿ≠ÿ∞ŸÅ ŸÖÿ¥⁄©ŸÑÿßÿ™ ŸÅÿ±ŸÖÿ™
            const num = parseFloat(numStr);
            if (isNaN(num)) return numStr;
            
            // ÿß⁄Øÿ± ÿπÿØÿØ ÿµÿ≠€åÿ≠ ÿßÿ≥ÿ™
            if (num % 1 === 0) return num.toString();
            
            // ÿ®ÿ±ÿß€å ÿßÿπÿØÿßÿØ ÿßÿπÿ¥ÿßÿ±€åÿå ÿ±ÿ¥ÿ™Ÿá ÿßÿµŸÑ€å ÿ±ÿß ÿ≠ŸÅÿ∏ ⁄©ŸÜ
            return trimTrailingZeros(numStr);
        }
        
        // ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ÿ±€åÿ≥⁄© ŸÖÿπÿßŸÖŸÑŸá ÿ®ÿß ÿ≠ŸÅÿ∏ ÿØŸÇ€åŸÇ ÿ±ÿ¥ÿ™Ÿá Ÿàÿ±ŸàÿØ€å
        function calculateRisk() {
            const entryPriceStr = document.getElementById('entryPrice').value.trim();
            const stopLossStr = document.getElementById('stopLoss').value.trim();
            const takeProfitStr = document.getElementById('takeProfit').value.trim();
            const riskPercentStr = document.getElementById('riskPercent').value.trim();
            const type = document.getElementById('type').value;
            
            // ÿ™ÿ®ÿØ€åŸÑ ÿ®Ÿá ÿπÿØÿØ ÿ®ÿ±ÿß€å ŸÖÿ≠ÿßÿ≥ÿ®ÿßÿ™
            const entryPrice = parseFloat(entryPriceStr) || 0;
            const stopLoss = parseFloat(stopLossStr) || 0;
            const takeProfit = parseFloat(takeProfitStr) || 0;
            const riskPercent = parseFloat(riskPercentStr) || 0;
            
            if (entryPrice <= 0 || stopLoss <= 0 || takeProfit <= 0 || riskPercent <= 0) {
                return;
            }
            
            // 1. ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ŸÖŸÇÿØÿßÿ± ÿ±€åÿ≥⁄© ÿØŸÑÿßÿ±€å
            const riskAmount = (accountBalance * riskPercent) / 100;
            
            // 2. ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ŸÅÿßÿµŸÑŸá ÿ≠ÿØ ÿ∂ÿ±ÿ± Ÿà ÿ≥ŸàÿØ (ŸÜŸÇÿ∑Ÿá)
            let stopLossPoints, takeProfitPoints;
            
            if (type === 'buy') {
                stopLossPoints = Math.abs(entryPrice - stopLoss);
                takeProfitPoints = Math.abs(takeProfit - entryPrice);
            } else {
                stopLossPoints = Math.abs(stopLoss - entryPrice);
                takeProfitPoints = Math.abs(entryPrice - takeProfit);
            }
            
            // 3. ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ÿßŸÜÿØÿßÿ≤Ÿá ŸæŸàÿ≤€åÿ¥ŸÜ
            const positionSize = riskAmount / stopLossPoints;
            
            // 4. ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ÿ≥ŸàÿØ ÿ®ÿßŸÑŸÇŸàŸá
            const potentialProfit = positionSize * takeProfitPoints;
            
            // 5. ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ŸÜÿ≥ÿ®ÿ™ ÿ±€åÿ≥⁄© ÿ®Ÿá ÿ±€åŸàÿßÿ±ÿØ
            const riskRewardRatio = stopLossPoints > 0 ? (takeProfitPoints / stopLossPoints).toFixed(2) : 0;
            
            // ŸÜŸÖÿß€åÿ¥ ŸÜÿ™ÿß€åÿ¨ ÿ®ÿß ŸÅÿ±ŸÖÿ™ ŸÖŸÜÿßÿ≥ÿ®
            document.getElementById('riskAmount').textContent = formatCurrency(riskAmount);
            document.getElementById('potentialProfit').textContent = formatCurrency(potentialProfit);
            document.getElementById('riskRewardRatio').textContent = '1:' + riskRewardRatio;
            
            return {
                riskAmount: riskAmount,
                positionSize: positionSize,
                potentialProfit: potentialProfit,
                riskRewardRatio: riskRewardRatio,
                entryPriceStr: entryPriceStr,
                stopLossStr: stopLossStr,
                takeProfitStr: takeProfitStr
            };
        }
        
        // ÿ´ÿ®ÿ™ ŸÖÿπÿßŸÖŸÑŸá ÿ¨ÿØ€åÿØ
        document.getElementById('tradeForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // ÿØÿ±€åÿßŸÅÿ™ ŸÖŸÇÿßÿØ€åÿ±
            const entryPriceStr = document.getElementById('entryPrice').value.trim();
            const stopLossStr = document.getElementById('stopLoss').value.trim();
            const takeProfitStr = document.getElementById('takeProfit').value.trim();
            const riskPercentStr = document.getElementById('riskPercent').value.trim();
            
            // ÿ™ÿ®ÿØ€åŸÑ ÿ®Ÿá ÿπÿØÿØ ÿ®ÿ±ÿß€å ÿßÿπÿ™ÿ®ÿßÿ±ÿ≥ŸÜÿ¨€å
            const entryPrice = parseFloat(entryPriceStr);
            const stopLoss = parseFloat(stopLossStr);
            const takeProfit = parseFloat(takeProfitStr);
            const riskPercent = parseFloat(riskPercentStr);
            
            // ÿßÿπÿ™ÿ®ÿßÿ±ÿ≥ŸÜÿ¨€å
            if (isNaN(entryPrice) || entryPrice <= 0 || 
                isNaN(stopLoss) || stopLoss <= 0 || 
                isNaN(takeProfit) || takeProfit <= 0 || 
                isNaN(riskPercent) || riskPercent <= 0) {
                showNotification('ŸÑÿ∑ŸÅÿßŸã ÿ™ŸÖÿßŸÖ ŸÅ€åŸÑÿØŸáÿß€å ÿ∂ÿ±Ÿàÿ±€å ÿ±ÿß ÿ®Ÿá ÿØÿ±ÿ≥ÿ™€å Ÿæÿ± ⁄©ŸÜ€åÿØ.', 'error');
                return;
            }
            
            // ÿßÿπÿ™ÿ®ÿßÿ±ÿ≥ŸÜÿ¨€å ÿ≠ÿØ ÿ∂ÿ±ÿ± Ÿà ÿ≥ŸàÿØ
            const type = document.getElementById('type').value;
            if (type === 'buy' && stopLoss >= entryPrice) {
                showNotification('ÿ®ÿ±ÿß€å ŸÑÿßŸÜ⁄Øÿå ÿ≠ÿØ ÿ∂ÿ±ÿ± ÿ®ÿß€åÿØ ⁄©ŸÖÿ™ÿ± ÿßÿ≤ ŸÇ€åŸÖÿ™ Ÿàÿ±ŸàÿØ ÿ®ÿßÿ¥ÿØ.', 'error');
                return;
            }
            if (type === 'sell' && stopLoss <= entryPrice) {
                showNotification('ÿ®ÿ±ÿß€å ÿ¥Ÿàÿ±ÿ™ÿå ÿ≠ÿØ ÿ∂ÿ±ÿ± ÿ®ÿß€åÿØ ÿ®€åÿ¥ÿ™ÿ± ÿßÿ≤ ŸÇ€åŸÖÿ™ Ÿàÿ±ŸàÿØ ÿ®ÿßÿ¥ÿØ.', 'error');
                return;
            }
            
            // ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ÿ±€åÿ≥⁄©
            const riskData = calculateRisk();
            if (!riskData) {
                showNotification('ÿÆÿ∑ÿß ÿØÿ± ŸÖÿ≠ÿßÿ≥ÿ®ÿßÿ™ ÿ±€åÿ≥⁄©.', 'error');
                return;
            }
            
            const trade = {
                id: Date.now(),
                symbol: document.getElementById('symbol').value.toUpperCase(),
                date: document.getElementById('date').value,
                type: type,
                entryPrice: entryPrice,
                entryPriceStr: preserveOriginalNumber(entryPriceStr),
                stopLoss: stopLoss,
                stopLossStr: preserveOriginalNumber(stopLossStr),
                takeProfit: takeProfit,
                takeProfitStr: preserveOriginalNumber(takeProfitStr),
                riskPercent: riskPercent,
                status: 'open',
                closedPrice: null,
                closedDate: null,
                riskAmount: riskData.riskAmount,
                positionSize: riskData.positionSize,
                potentialProfit: riskData.potentialProfit,
                riskRewardRatio: riskData.riskRewardRatio
            };
            
            trades.push(trade);
            saveTrades();
            loadTrades();
            updateStats();
            updateTotalRisk();
            
            // Ÿæÿß⁄© ⁄©ÿ±ÿØŸÜ ŸÅÿ±ŸÖ
            this.reset();
            
            // ÿ™ŸÜÿ∏€åŸÖ ŸÖÿ¨ÿØÿØ ÿ™ÿßÿ±€åÿÆ Ÿà ŸÖŸÇÿßÿØ€åÿ± Ÿæ€åÿ¥‚ÄåŸÅÿ±ÿ∂
            const now = new Date();
            const timezoneOffset = now.getTimezoneOffset() * 60000;
            const localISOTime = new Date(now - timezoneOffset).toISOString().slice(0, 16);
            document.getElementById('date').value = localISOTime;
            document.getElementById('riskPercent').value = "0.5";
            
            showNotification('ŸÖÿπÿßŸÖŸÑŸá ÿ®ÿß ŸÖŸàŸÅŸÇ€åÿ™ ÿ´ÿ®ÿ™ ÿ¥ÿØ!', 'success');
        });
        
        // ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ÿ±€åÿ≥⁄© ŸÖÿπÿßŸÖŸÑŸá ÿ∞ÿÆ€åÿ±Ÿá ÿ¥ÿØŸá
        function calculateTradeRisk(trade) {
            let stopLossPoints;
            
            if (trade.type === 'buy') {
                stopLossPoints = Math.abs(trade.entryPrice - trade.stopLoss);
            } else {
                stopLossPoints = Math.abs(trade.stopLoss - trade.entryPrice);
            }
            
            const riskAmount = (accountBalance * trade.riskPercent) / 100;
            const positionSize = riskAmount / stopLossPoints;
            
            return {
                riskAmount: riskAmount,
                positionSize: positionSize
            };
        }
        
        // ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å ŸÖÿπÿßŸÖŸÑÿßÿ™ ÿØÿ± ÿ¨ÿØŸàŸÑ
        function loadTrades() {
            const tbody = document.getElementById('tradesTableBody');
            const noTradesMessage = document.getElementById('noTradesMessage');
            
            if (trades.length === 0) {
                tbody.innerHTML = '';
                noTradesMessage.style.display = 'block';
                return;
            }
            
            noTradesMessage.style.display = 'none';
            
            // ŸÖÿ±ÿ™ÿ®‚Äåÿ≥ÿßÿ≤€å ŸÖÿπÿßŸÖŸÑÿßÿ™ (ÿ¨ÿØ€åÿØÿ™ÿ±€åŸÜ ÿßŸàŸÑ)
            const sortedTrades = [...trades].sort((a, b) => new Date(b.date) - new Date(a.date));
            
            let html = '';
            sortedTrades.forEach(trade => {
                const pnl = calculateTradePnL(trade);
                const pnlClass = pnl > 0 ? 'profit' : (pnl < 0 ? 'loss' : 'neutral');
                const pnlText = trade.status === 'closed' ? 
                    (pnl >= 0 ? '+' : '') + formatCurrency(Math.abs(pnl)) : 
                    'ÿ®ÿßÿ≤';
                
                const typeText = trade.type === 'buy' ? 'ŸÑÿßŸÜ⁄Ø' : 'ÿ¥Ÿàÿ±ÿ™';
                const statusText = trade.status === 'open' ? 'ÿ®ÿßÿ≤' : 'ÿ®ÿ≥ÿ™Ÿá';
                const statusClass = trade.status === 'open' ? 'profit' : 'neutral';
                
                const date = new Date(trade.date);
                const dateText = date.toLocaleDateString('fa-IR') + ' ' + 
                                date.getHours().toString().padStart(2, '0') + ':' + 
                                date.getMinutes().toString().padStart(2, '0');
                
                // ÿßÿ≥ÿ™ŸÅÿßÿØŸá ÿßÿ≤ ÿ±ÿ¥ÿ™Ÿá ÿßÿµŸÑ€å ÿ∞ÿÆ€åÿ±Ÿá ÿ¥ÿØŸá ÿ®ÿ±ÿß€å ŸÜŸÖÿß€åÿ¥
                const displayEntryPrice = trade.entryPriceStr || trade.entryPrice;
                const displayStopLoss = trade.stopLossStr || trade.stopLoss;
                const displayTakeProfit = trade.takeProfitStr || trade.takeProfit;
                
                html += `
                <tr>
                    <td>
                        <div class="crypto-badge">
                            <i class="fas fa-coins"></i>
                            ${trade.symbol}
                        </div>
                    </td>
                    <td>${dateText}</td>
                    <td>${typeText}</td>
                    <td class="price-display">${displayEntryPrice}</td>
                    <td class="price-display">${displayStopLoss}</td>
                    <td class="price-display">${displayTakeProfit}</td>
                    <td>${trade.riskPercent.toFixed(2)}%</td>
                    <td><span class="${statusClass}">${statusText}</span></td>
                    <td><span class="${pnlClass}">${pnlText}</span></td>
                    <td class="actions">
                        <button class="btn-icon" onclick="showTradeDetails(${trade.id})" style="background-color: rgba(14, 165, 233, 0.1); color: #0ea5e9; border: 1px solid rgba(14, 165, 233, 0.3);">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="btn-icon" onclick="editTrade(${trade.id})" style="background-color: rgba(245, 158, 11, 0.1); color: #f59e0b; border: 1px solid rgba(245, 158, 11, 0.3);">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn-icon" onclick="closeTrade(${trade.id})" style="background-color: rgba(59, 130, 246, 0.1); color: #3b82f6; border: 1px solid rgba(59, 130, 246, 0.3);" ${trade.status === 'closed' ? 'disabled' : ''}>
                            <i class="fas fa-check-circle"></i>
                        </button>
                        <button class="btn-icon" onclick="deleteTrade(${trade.id})" style="background-color: rgba(239, 68, 68, 0.1); color: #ef4444; border: 1px solid rgba(239, 68, 68, 0.3);">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
                `;
            });
            
            tbody.innerHTML = html;
        }
        
        // ŸÜŸÖÿß€åÿ¥ ÿ¨ÿ≤ÿ¶€åÿßÿ™ ŸÖÿπÿßŸÖŸÑŸá
        function showTradeDetails(tradeId) {
            const trade = trades.find(t => t.id === tradeId);
            if (!trade) return;
            
            // Ÿæÿ± ⁄©ÿ±ÿØŸÜ ŸÖŸàÿØÿßŸÑ ÿ®ÿß ÿßÿ∑ŸÑÿßÿπÿßÿ™ ŸÖÿπÿßŸÖŸÑŸá
            document.getElementById('detail-symbol').textContent = trade.symbol;
            document.getElementById('detail-type').textContent = trade.type === 'buy' ? 'ŸÑÿßŸÜ⁄Ø' : 'ÿ¥Ÿàÿ±ÿ™';
            
            // ŸÅÿ±ŸÖÿ™ ÿ™ÿßÿ±€åÿÆ
            const date = new Date(trade.date);
            const dateText = date.toLocaleDateString('fa-IR') + ' - ' + 
                            date.getHours().toString().padStart(2, '0') + ':' + 
                            date.getMinutes().toString().padStart(2, '0');
            document.getElementById('detail-date').textContent = dateText;
            
            // Ÿàÿ∂ÿπ€åÿ™ ŸÖÿπÿßŸÖŸÑŸá
            const statusText = trade.status === 'open' ? 'ÿ®ÿßÿ≤' : 'ÿ®ÿ≥ÿ™Ÿá';
            const statusClass = trade.status === 'open' ? 'profit' : 'neutral';
            const statusElement = document.getElementById('detail-status');
            statusElement.textContent = statusText;
            statusElement.className = 'detail-value ' + statusClass;
            
            // ŸÇ€åŸÖÿ™‚ÄåŸáÿß (ÿ®ÿß ÿ±ÿ¥ÿ™Ÿá ÿßÿµŸÑ€å ÿ∞ÿÆ€åÿ±Ÿá ÿ¥ÿØŸá)
            document.getElementById('detail-entry').textContent = trade.entryPriceStr || trade.entryPrice;
            document.getElementById('detail-sl').textContent = trade.stopLossStr || trade.stopLoss;
            document.getElementById('detail-tp').textContent = trade.takeProfitStr || trade.takeProfit;
            
            // ŸÖÿ≠ÿßÿ≥ÿ®ÿßÿ™ ÿ±€åÿ≥⁄©
            document.getElementById('detail-risk-percent').textContent = trade.riskPercent.toFixed(2) + '%';
            document.getElementById('detail-risk-amount').textContent = formatCurrency(trade.riskAmount || 0);
            document.getElementById('detail-position-size').textContent = formatNumber(trade.positionSize || 0);
            document.getElementById('detail-rr').textContent = '1:' + (trade.riskRewardRatio || 0);
            
            // ÿß⁄Øÿ± ŸÖÿπÿßŸÖŸÑŸá ÿ®ÿ≥ÿ™Ÿá ÿ¥ÿØŸá ÿ®ÿßÿ¥ÿØ
            if (trade.status === 'closed') {
                document.getElementById('detail-closed-price-container').style.display = 'block';
                document.getElementById('detail-result-section').style.display = 'block';
                
                document.getElementById('detail-closed-price').textContent = trade.closedPrice || '0';
                
                const pnl = calculateTradePnL(trade);
                const pnlElement = document.getElementById('detail-pnl');
                pnlElement.textContent = (pnl >= 0 ? '+' : '') + formatCurrency(Math.abs(pnl));
                pnlElement.style.color = pnl >= 0 ? '#10b981' : '#ef4444';
                
                if (trade.closedDate) {
                    const closedDate = new Date(trade.closedDate);
                    const closedDateText = closedDate.toLocaleDateString('fa-IR') + ' - ' + 
                                         closedDate.getHours().toString().padStart(2, '0') + ':' + 
                                         closedDate.getMinutes().toString().padStart(2, '0');
                    document.getElementById('detail-closed-date').textContent = closedDateText;
                }
            } else {
                document.getElementById('detail-closed-price-container').style.display = 'none';
                document.getElementById('detail-result-section').style.display = 'none';
            }
            
            // ŸÜŸÖÿß€åÿ¥ ŸÖŸàÿØÿßŸÑ
            document.getElementById('detailsModal').style.display = 'flex';
        }
        
        // ÿ®ÿ≥ÿ™ŸÜ ŸÖŸàÿØÿßŸÑ ÿ¨ÿ≤ÿ¶€åÿßÿ™ ŸÖÿπÿßŸÖŸÑŸá
        function closeDetailsModal() {
            document.getElementById('detailsModal').style.display = 'none';
        }
        
        // ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ÿ≥ŸàÿØ/ÿ∂ÿ±ÿ± €å⁄© ŸÖÿπÿßŸÖŸÑŸá ÿ®ÿ≥ÿ™Ÿá ÿ¥ÿØŸá
        function calculateTradePnL(trade) {
            if (trade.status !== 'closed' || !trade.closedPrice) return 0;
            
            let priceDifference;
            
            if (trade.type === 'buy') {
                priceDifference = trade.closedPrice - trade.entryPrice;
            } else {
                priceDifference = trade.entryPrice - trade.closedPrice;
            }
            
            const pnl = trade.positionSize * priceDifference;
            
            return pnl;
        }
        
        // ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ÿ≥ŸàÿØ/ÿ∂ÿ±ÿ± ⁄©ŸÑ
        function calculateTotalPnL() {
            let total = 0;
            trades.forEach(trade => {
                total += calculateTradePnL(trade);
            });
            return total;
        }
        
        // ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ÿ≥ŸàÿØ ⁄©ŸÑ
        function calculateTotalProfit() {
            let total = 0;
            trades.forEach(trade => {
                const pnl = calculateTradePnL(trade);
                if (pnl > 0) {
                    total += pnl;
                }
            });
            return total;
        }
        
        // ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ÿ∂ÿ±ÿ± ⁄©ŸÑ
        function calculateTotalLoss() {
            let total = 0;
            trades.forEach(trade => {
                const pnl = calculateTradePnL(trade);
                if (pnl < 0) {
                    total += Math.abs(pnl);
                }
            });
            return total;
        }
        
        // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å ÿ¢ŸÖÿßÿ±
        function updateStats() {
            if (trades.length === 0) {
                resetStats();
                return;
            }
            
            const closedTrades = trades.filter(t => t.status === 'closed');
            const openTrades = trades.filter(t => t.status === 'open');
            const totalTrades = trades.length;
            
            // ŸÖÿ≠ÿßÿ≥ÿ®ÿßÿ™ ÿ¢ŸÖÿßÿ±€å
            let totalPnl = 0;
            let profitableTrades = 0;
            let maxProfit = 0;
            let maxLoss = 0;
            
            closedTrades.forEach(trade => {
                const pnl = calculateTradePnL(trade);
                totalPnl += pnl;
                
                if (pnl > 0) {
                    profitableTrades++;
                    if (pnl > maxProfit) maxProfit = pnl;
                } else if (pnl < maxLoss) {
                    maxLoss = pnl;
                }
            });
            
            // ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ÿ≥ŸàÿØ ⁄©ŸÑ Ÿà ÿ∂ÿ±ÿ± ⁄©ŸÑ ÿ¨ÿØÿß⁄ØÿßŸÜŸá
            const totalProfit = calculateTotalProfit();
            const totalLoss = calculateTotalLoss();
            
            // ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ÿØÿ±ÿµÿØŸáÿß
            const winRate = closedTrades.length > 0 ? (profitableTrades / closedTrades.length) * 100 : 0;
            
            // ÿ®Ÿá‚Äåÿ±Ÿàÿ≤ÿ±ÿ≥ÿßŸÜ€å ŸÜŸÖÿß€åÿ¥
            document.getElementById('totalTrades').textContent = totalTrades;
            document.getElementById('openTrades').textContent = openTrades.length;
            
            // ÿ≥ŸàÿØ ⁄©ŸÑ
            const totalProfitElement = document.getElementById('totalProfit');
            totalProfitElement.textContent = formatCurrency(totalProfit);
            totalProfitElement.className = totalProfit > 0 ? 'stat-value positive' : 'stat-value neutral-stat';
            
            // ÿ∂ÿ±ÿ± ⁄©ŸÑ
            const totalLossElement = document.getElementById('totalLoss');
            totalLossElement.textContent = formatCurrency(totalLoss);
            totalLossElement.className = totalLoss > 0 ? 'stat-value negative' : 'stat-value neutral-stat';
            
            document.getElementById('winRate').textContent = winRate.toFixed(1) + '%';
            document.getElementById('maxProfit').textContent = '+' + formatCurrency(Math.abs(maxProfit));
            document.getElementById('maxLoss').textContent = formatCurrency(Math.abs(maxLoss));
        }
        
        function resetStats() {
            document.getElementById('totalTrades').textContent = '0';
            document.getElementById('openTrades').textContent = '0';
            document.getElementById('totalProfit').textContent = '$0.00';
            document.getElementById('totalProfit').className = 'stat-value neutral-stat';
            document.getElementById('totalLoss').textContent = '$0.00';
            document.getElementById('totalLoss').className = 'stat-value neutral-stat';
            document.getElementById('winRate').textContent = '0%';
            document.getElementById('maxProfit').textContent = '$0.00';
            document.getElementById('maxLoss').textContent = '$0.00';
        }
        
        // Ÿà€åÿ±ÿß€åÿ¥ ŸÖÿπÿßŸÖŸÑŸá
        function editTrade(id) {
            const trade = trades.find(t => t.id === id);
            if (!trade) return;
            
            // Ÿæÿ± ⁄©ÿ±ÿØŸÜ ŸÅÿ±ŸÖ ÿ®ÿß ÿ±ÿ¥ÿ™Ÿá ÿßÿµŸÑ€å ÿ∞ÿÆ€åÿ±Ÿá ÿ¥ÿØŸá
            document.getElementById('symbol').value = trade.symbol;
            document.getElementById('date').value = trade.date;
            document.getElementById('type').value = trade.type;
            document.getElementById('entryPrice').value = trade.entryPriceStr || trade.entryPrice;
            document.getElementById('stopLoss').value = trade.stopLossStr || trade.stopLoss;
            document.getElementById('takeProfit').value = trade.takeProfitStr || trade.takeProfit;
            document.getElementById('riskPercent').value = trade.riskPercent;
            
            // ÿ≠ÿ∞ŸÅ ŸÖÿπÿßŸÖŸÑŸá ŸÇÿØ€åŸÖ€å
            trades = trades.filter(t => t.id !== id);
            
            calculateRisk();
            showNotification('ŸÖÿπÿßŸÖŸÑŸá ÿ®ÿ±ÿß€å Ÿà€åÿ±ÿß€åÿ¥ ÿ¢ŸÖÿßÿØŸá ÿßÿ≥ÿ™.', 'info');
        }
        
        // ÿ®ÿ≥ÿ™ŸÜ ŸÖÿπÿßŸÖŸÑŸá
        function closeTrade(id) {
            const closePrice = prompt('ŸÇ€åŸÖÿ™ ÿ®ÿ≥ÿ™Ÿá ÿ¥ÿØŸÜ ŸÖÿπÿßŸÖŸÑŸá ÿ±ÿß Ÿàÿßÿ±ÿØ ⁄©ŸÜ€åÿØ:');
            if (!closePrice || isNaN(parseFloat(closePrice))) {
                showNotification('ŸÇ€åŸÖÿ™ ŸÜÿßŸÖÿπÿ™ÿ®ÿ± ÿßÿ≥ÿ™.', 'error');
                return;
            }
            
            const tradeIndex = trades.findIndex(t => t.id === id);
            if (tradeIndex !== -1) {
                trades[tradeIndex].status = 'closed';
                trades[tradeIndex].closedPrice = parseFloat(closePrice);
                trades[tradeIndex].closedDate = new Date().toISOString();
                
                saveTrades();
                loadTrades();
                updateStats();
                updateTotalRisk();
                showNotification('ŸÖÿπÿßŸÖŸÑŸá ÿ®ÿ≥ÿ™Ÿá ÿ¥ÿØ.', 'success');
            }
        }
        
        // ÿ≠ÿ∞ŸÅ ŸÖÿπÿßŸÖŸÑŸá
        function deleteTrade(id) {
            if (confirm('ÿ¢€åÿß ÿßÿ≤ ÿ≠ÿ∞ŸÅ ÿß€åŸÜ ŸÖÿπÿßŸÖŸÑŸá ÿßÿ∑ŸÖ€åŸÜÿßŸÜ ÿØÿßÿ±€åÿØÿü')) {
                trades = trades.filter(trade => trade.id !== id);
                saveTrades();
                loadTrades();
                updateStats();
                updateTotalRisk();
                showNotification('ŸÖÿπÿßŸÖŸÑŸá ÿ≠ÿ∞ŸÅ ÿ¥ÿØ.', 'warning');
            }
        }
        
        // ÿ∞ÿÆ€åÿ±Ÿá ŸÖÿπÿßŸÖŸÑÿßÿ™
        function saveTrades() {
            localStorage.setItem('crypto_trades', JSON.stringify(trades));
        }
        
        // Ÿæÿ¥ÿ™€åÿ®ÿßŸÜ‚Äå⁄Ø€åÿ±€å - ÿØÿ±€åÿßŸÅÿ™ ŸÅÿß€åŸÑ JSON
        function exportData() {
            const data = {
                balance: accountBalance,
                trades: trades,
                exportDate: new Date().toISOString(),
                version: '1.0'
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `crypto-journal-backup-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('Ÿæÿ¥ÿ™€åÿ®ÿßŸÜ ÿ®ÿß ŸÖŸàŸÅŸÇ€åÿ™ ÿØÿßŸÜŸÑŸàÿØ ÿ¥ÿØ.', 'success');
        }
        
        // Ÿæÿ¥ÿ™€åÿ®ÿßŸÜ‚Äå⁄Ø€åÿ±€å - ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å ŸÅÿß€åŸÑ JSON
        function importData() {
            const fileInput = document.getElementById('backupFile');
            const file = fileInput.files[0];
            
            if (!file) {
                showNotification('ŸÑÿ∑ŸÅÿßŸã €å⁄© ŸÅÿß€åŸÑ ÿßŸÜÿ™ÿÆÿßÿ® ⁄©ŸÜ€åÿØ.', 'error');
                return;
            }
            
            if (!file.name.endsWith('.json')) {
                showNotification('ŸÑÿ∑ŸÅÿßŸã €å⁄© ŸÅÿß€åŸÑ JSON ÿßŸÜÿ™ÿÆÿßÿ® ⁄©ŸÜ€åÿØ.', 'error');
                return;
            }
            
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    if (confirm('ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å ÿß€åŸÜ ŸÅÿß€åŸÑÿå ÿßÿ∑ŸÑÿßÿπÿßÿ™ ŸÅÿπŸÑ€å ÿ±ÿß ÿ¨ÿß€å⁄Øÿ≤€åŸÜ ŸÖ€å‚Äå⁄©ŸÜÿØ. ÿßÿØÿßŸÖŸá ŸÖ€å‚ÄåÿØŸá€åÿØÿü')) {
                        if (data.balance) {
                            accountBalance = data.balance;
                            localStorage.setItem('crypto_account_balance', accountBalance);
                        }
                        
                        if (data.trades && Array.isArray(data.trades)) {
                            trades = data.trades;
                            localStorage.setItem('crypto_trades', JSON.stringify(trades));
                        }
                        
                        updateBalanceDisplay();
                        updateTotalRisk();
                        loadTrades();
                        updateStats();
                        fileInput.value = '';
                        
                        showNotification('ÿßÿ∑ŸÑÿßÿπÿßÿ™ ÿ®ÿß ŸÖŸàŸÅŸÇ€åÿ™ ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å ÿ¥ÿØŸÜÿØ.', 'success');
                    }
                } catch (error) {
                    showNotification('ÿÆÿ∑ÿß ÿØÿ± ÿÆŸàÿßŸÜÿØŸÜ ŸÅÿß€åŸÑ. ŸÑÿ∑ŸÅÿßŸã ŸÅÿß€åŸÑ ŸÖÿπÿ™ÿ®ÿ± ÿßŸÜÿ™ÿÆÿßÿ® ⁄©ŸÜ€åÿØ.', 'error');
                    console.error('Error reading backup file:', error);
                }
            };
            
            reader.readAsText(file);
        }
        
        // ŸÜŸÖÿß€åÿ¥ ÿßÿπŸÑÿßŸÜ
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.textContent = message;
            notification.style.position = 'fixed';
            notification.style.top = '20px';
            notification.style.left = '50%';
            notification.style.transform = 'translateX(-50%)';
            notification.style.padding = '12px 20px';
            notification.style.borderRadius = '8px';
            notification.style.zIndex = '1000';
            notification.style.fontWeight = '600';
            notification.style.boxShadow = '0 5px 15px rgba(0, 0, 0, 0.3)';
            
            if (type === 'success') {
                notification.style.backgroundColor = '#10b981';
                notification.style.color = 'white';
            } else if (type === 'warning') {
                notification.style.backgroundColor = '#f59e0b';
                notification.style.color = '#78350f';
            } else if (type === 'error') {
                notification.style.backgroundColor = '#ef4444';
                notification.style.color = 'white';
            } else {
                notification.style.backgroundColor = '#3b82f6';
                notification.style.color = 'white';
            }
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transition = 'opacity 0.5s';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 500);
            }, 3000);
        }
        
        // ============================
        // ÿ®ÿÆÿ¥ ŸÖÿßÿ¥€åŸÜ‚Äåÿ≠ÿ≥ÿßÿ® ŸÖÿØ€åÿ±€åÿ™ ÿ±€åÿ≥⁄©
        // ============================
        
        // ŸÖŸÇÿØÿßÿ±ÿØŸá€å ÿßŸàŸÑ€åŸá ŸÖÿßÿ¥€åŸÜ‚Äåÿ≠ÿ≥ÿßÿ®
        function initCalculator() {
            // ÿØ⁄©ŸÖŸá‚ÄåŸáÿß€å ÿ≥ÿ±€åÿπ ÿØÿ±ÿµÿØ ÿ±€åÿ≥⁄©
            document.querySelectorAll('.calculator-risk-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    // ÿ≠ÿ∞ŸÅ active ÿßÿ≤ ŸáŸÖŸá ÿØ⁄©ŸÖŸá‚ÄåŸáÿß
                    document.querySelectorAll('.calculator-risk-btn').forEach(b => {
                        b.classList.remove('active');
                    });
                    
                    // ÿßÿ∂ÿßŸÅŸá ⁄©ÿ±ÿØŸÜ active ÿ®Ÿá ÿØ⁄©ŸÖŸá ÿßŸÜÿ™ÿÆÿßÿ® ÿ¥ÿØŸá
                    this.classList.add('active');
                    
                    // ÿ™ŸÜÿ∏€åŸÖ ŸÖŸÇÿØÿßÿ± ÿØÿ± ŸÅ€åŸÑÿØ
                    const riskValue = this.getAttribute('data-risk');
                    document.getElementById('calcRiskPercent').value = riskValue;
                    
                    // ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ŸÖÿ¨ÿØÿØ
                    calculateRiskMargin();
                });
            });
            
            // ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ŸÖÿßÿ±ÿ¨€åŸÜ ŸÖŸàÿ±ÿØ ŸÜ€åÿßÿ≤
            document.getElementById('calcCalculate').addEventListener('click', calculateRiskMargin);
            
            // ÿ±€åÿ≥ÿ™ ŸÅÿ±ŸÖ ŸÖÿßÿ¥€åŸÜ‚Äåÿ≠ÿ≥ÿßÿ®
            document.getElementById('calcReset').addEventListener('click', resetCalculatorForm);
            
            // ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ÿÆŸàÿØ⁄©ÿßÿ± ÿ®ÿß ÿ™ÿ∫€å€åÿ± ŸÖŸÇÿßÿØ€åÿ±
            document.querySelectorAll('.calculator-input-with-unit input').forEach(input => {
                input.addEventListener('input', calculateRiskMargin);
                input.addEventListener('change', calculateRiskMargin);
            });
            
            // ÿ™ŸÜÿ∏€åŸÖ ŸÖŸÇÿØÿßÿ± Ÿæ€åÿ¥‚ÄåŸÅÿ±ÿ∂ ÿ®ÿßŸÑÿßŸÜÿ≥ ÿßÿ≤ ÿ≠ÿ≥ÿßÿ® ⁄òŸàÿ±ŸÜÿßŸÑ
            document.getElementById('calcBalance').value = accountBalance;
        }
        
        // ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ŸÖÿßÿ±ÿ¨€åŸÜ ŸÖŸàÿ±ÿØ ŸÜ€åÿßÿ≤
        function calculateRiskMargin() {
            // ÿØÿ±€åÿßŸÅÿ™ ŸÖŸÇÿßÿØ€åÿ±
            const balance = parseFloat(document.getElementById('calcBalance').value);
            const riskPercent = parseFloat(document.getElementById('calcRiskPercent').value);
            const stopLossPercent = parseFloat(document.getElementById('calcStopLossPercent').value);
            const leverage = parseFloat(document.getElementById('calcLeverage').value);
            
            // ÿ®ÿ±ÿ±ÿ≥€å ŸÖŸÇÿßÿØ€åÿ± Ÿàÿ±ŸàÿØ€å
            if (!balance || !riskPercent || !stopLossPercent || !leverage) {
                document.getElementById('calcResult').style.display = 'none';
                return;
            }
            
            // 1. ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ŸÖÿ®ŸÑÿ∫ ÿ±€åÿ≥⁄©
            const riskAmount = balance * (riskPercent / 100);
            
            // 2. ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ÿ≠ÿ¨ŸÖ ŸæŸàÿ≤€åÿ¥ŸÜ
            const positionSize = riskAmount / (stopLossPercent / 100);
            
            // 3. ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ŸÖÿßÿ±ÿ¨€åŸÜ ŸÖŸàÿ±ÿØ ŸÜ€åÿßÿ≤
            const marginRequired = positionSize / leverage;
            
            // ŸÜŸÖÿß€åÿ¥ ŸÜÿ™ÿß€åÿ¨
            document.getElementById('calcRiskAmount').textContent = `$${riskAmount.toFixed(2)}`;
            document.getElementById('calcMarginRequired').textContent = `$${marginRequired.toFixed(2)}`;
            
            // ÿ™ŸÜÿ∏€åŸÖ ÿßÿ≥ÿ™ÿß€åŸÑ Ÿáÿ¥ÿØÿßÿ±Ÿáÿß
            const riskItem = document.getElementById('calcRiskResultItem');
            const marginItem = document.getElementById('calcMarginResultItem');
            
            // ÿ±€åÿ≥ÿ™ ⁄©ŸÑÿßÿ≥‚ÄåŸáÿß
            riskItem.className = 'calculator-result-item';
            marginItem.className = 'calculator-result-item';
            
            // Ÿáÿ¥ÿØÿßÿ± ÿ®ÿ±ÿß€å ÿ±€åÿ≥⁄© ÿ®ÿßŸÑÿß
            if (riskPercent > 2) {
                riskItem.classList.add('calculator-warning-medium');
            }
            if (riskPercent > 3) {
                riskItem.classList.add('calculator-warning-high');
            }
            
            // Ÿáÿ¥ÿØÿßÿ± ÿ®ÿ±ÿß€å ŸÑŸàÿ±€åÿ¨ ÿ®ÿßŸÑÿß
            if (leverage > 50) {
                marginItem.classList.add('calculator-warning-medium');
            }
            if (leverage > 100) {
                marginItem.classList.add('calculator-warning-high');
            }
            
            // Ÿáÿ¥ÿØÿßÿ± ÿß⁄Øÿ± ŸÖÿßÿ±ÿ¨€åŸÜ ÿ®€åÿ¥ÿ™ÿ± ÿßÿ≤ ÿ®ÿßŸÑÿßŸÜÿ≥ ÿ®ÿßÿ¥ÿØ
            if (marginRequired > balance) {
                marginItem.classList.add('calculator-warning-high');
            }
            
            // ŸÜŸÖÿß€åÿ¥ ŸÜÿ™ÿß€åÿ¨
            document.getElementById('calcResult').style.display = 'block';
        }
        
        // ÿ±€åÿ≥ÿ™ ŸÅÿ±ŸÖ ŸÖÿßÿ¥€åŸÜ‚Äåÿ≠ÿ≥ÿßÿ®
        function resetCalculatorForm() {
            // ÿ±€åÿ≥ÿ™ ŸÖŸÇÿßÿØ€åÿ±
            document.getElementById('calcBalance').value = accountBalance;
            document.getElementById('calcRiskPercent').value = '1';
            document.getElementById('calcStopLossPercent').value = '5';
            document.getElementById('calcLeverage').value = '10';
            
            // ÿ±€åÿ≥ÿ™ ÿØ⁄©ŸÖŸá‚ÄåŸáÿß€å ŸÅÿπÿßŸÑ
            document.querySelectorAll('.calculator-risk-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // ŸÅÿπÿßŸÑ ⁄©ÿ±ÿØŸÜ ÿØ⁄©ŸÖŸá 0.5% Ÿæ€åÿ¥‚ÄåŸÅÿ±ÿ∂
            document.querySelector('.calculator-risk-btn[data-risk="0.5"]').classList.add('active');
            
            // ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ŸÖÿ¨ÿØÿØ
            calculateRiskMargin();
        }
        
        // ÿ®ÿßÿ≤ ⁄©ÿ±ÿØŸÜ ŸÖÿßÿ¥€åŸÜ‚Äåÿ≠ÿ≥ÿßÿ®
        function openCalculator() {
            // ÿ™ŸÜÿ∏€åŸÖ ÿ®ÿßŸÑÿßŸÜÿ≥ ŸÅÿπŸÑ€å ÿØÿ± ŸÖÿßÿ¥€åŸÜ‚Äåÿ≠ÿ≥ÿßÿ®
            document.getElementById('calcBalance').value = accountBalance;
            
            // ŸÖÿ≠ÿßÿ≥ÿ®Ÿá Ÿà ŸÜŸÖÿß€åÿ¥ ŸÜÿ™ÿß€åÿ¨
            calculateRiskMargin();
            
            // ŸÜŸÖÿß€åÿ¥ ŸÖŸàÿØÿßŸÑ
            document.getElementById('calculatorModal').style.display = 'flex';
        }
        
        // ÿ®ÿ≥ÿ™ŸÜ ŸÖÿßÿ¥€åŸÜ‚Äåÿ≠ÿ≥ÿßÿ®
        function closeCalculator() {
            document.getElementById('calculatorModal').style.display = 'none';
        }
        
        // ŸÖÿ≠ÿßÿ≥ÿ®Ÿá ÿßŸàŸÑ€åŸá ŸáŸÜ⁄ØÿßŸÖ ÿ®ÿßÿ±⁄Øÿ∞ÿßÿ±€å
        window.addEventListener('load', function() {
            calculateRiskMargin();
        });
    </script>
</body>
</html>